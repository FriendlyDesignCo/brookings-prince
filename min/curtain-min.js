!function($,t,e,n){function i(t,e){var n=this;this.element=t,this.options=$.extend({},o,e),this._defaults=o,this._name=s,this._ignoreHashChange=!1,this.init()}var s="curtain",o={scrollSpeed:400,bodyHeight:0,linksArray:[],mobile:!1,scrollButtons:{},controls:null,curtainLinks:".curtain-links",enableKeys:!0,easing:"swing",disabled:!1,nextSlide:function(){},prevSlide:function(){}};i.prototype={init:function(){var n=this;this.$element=$(this.element),this.$li=$(this.element).find(">li"),this.$liLength=this.$li.length,n.$windowHeight=$(t).height(),n.$elDatas={},n.$document=$(e),n.$window=$(t),n.webkit=navigator.userAgent.indexOf("Chrome")>-1||navigator.userAgent.indexOf("Safari")>-1,$.Android=navigator.userAgent.match(/Android/i),$.iPhone=navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPod/i),$.iPad=navigator.userAgent.match(/iPad/i),$.iOs4=/OS [1-4]_[0-9_]+ like Mac OS X/i.test(navigator.userAgent),($.iPhone||$.iPad||$.Android||n.options.disabled)&&(this.options.mobile=!0,this.$li.css({position:"relative"}),this.$element.find(".fixed").css({position:"absolute"})),this.options.mobile?this.scrollEl=this.$element:$.mozilla||$.msie?this.scrollEl=$("html"):this.scrollEl=$("body"),n.options.controls&&(n.options.scrollButtons.up=$(n.options.controls).find('[href="#up"]'),n.options.scrollButtons.down=$(n.options.controls).find('[href="#down"]'),$.iOs4||!$.iPhone&&!$.iPad||(n.$element.css({position:"fixed",top:0,left:0,right:0,bottom:0,"-webkit-overflow-scrolling":"touch",overflow:"auto"}),$(n.options.controls).css({position:"absolute"})));var i=function(){n.setDimensions(),n.$li.eq(0).addClass("current"),n.setCache(),n.options.mobile||n.$li.eq(1).length&&n.$li.eq(1).nextAll().addClass("hidden"),n.setEvents(),n.setLinks(),n.isHashIsOnList(location.hash.substring(1))};n.$element.find("img").length?n.imageLoaded(i):i()},scrollToPosition:function(t){var e=null,i=this;if(i.scrollEl.is(":animated"))return!1;if("up"===t||"down"==t){var s="up"===t?i.$current.prev():i.$current.next();if(i.$step){i.$current.find(".current-step").length||i.$step.eq(0).addClass("current-step");var o="up"===t?i.$current.find(".current-step").prev(".step"):i.$current.find(".current-step").next(".step");o.length&&(e=i.options.mobile?o.position().top+i.$elDatas[i.$current.index()]["data-position"]:o.position().top+i.$elDatas[i.$current.index()]["data-position"])}e=e||(i.$elDatas[s.index()]===n?null:i.$elDatas[s.index()]["data-position"]),null!==e&&i.scrollEl.animate({scrollTop:e},i.options.scrollSpeed,i.options.easing)}else if("top"===t)i.scrollEl.animate({scrollTop:0},i.options.scrollSpeed,i.options.easing);else if("bottom"===t)i.scrollEl.animate({scrollTop:i.options.bodyHeight},i.options.scrollSpeed,i.options.easing);else{var r=$("#"+t).index(),a=4*Math.abs(i.currentIndex-r)*this.options.scrollSpeed/i.$liLength;i.scrollEl.animate({scrollTop:i.$elDatas[r]["data-position"]||null},a<=i.options.scrollSpeed?i.options.scrollSpeed:a,this.options.easing)}},scrollEvent:function(){var t=this,e=t.$document.scrollTop();if(e<t.currentP&&t.currentIndex>0)t._ignoreHashChange=!0,t.$current.prev().attr("id")&&t.setHash(t.$current.prev().attr("id")),t.$current.removeClass("current").css(t.webkit?{"-webkit-transform":"translateY(0px) translateZ(0)"}:{marginTop:0}).nextAll().addClass("hidden").end().prev().addClass("current").removeClass("hidden"),t.setCache(),t.options.prevSlide();else if(e<t.currentP+t.currentHeight){if(t.webkit?t.$current.css({"-webkit-transform":"translateY("+-(e-t.currentP)+"px) translateZ(0)"}):t.$current.css({marginTop:-(e-t.currentP)}),t.$fixedLength){var n=parseInt(t.$fixed.attr("data-top"),10);e+t.$windowHeight>=t.currentP+t.currentHeight?t.$fixed.css({position:"fixed"}):t.$fixed.css({position:"absolute",marginTop:Math.abs(e-t.currentP)})}t.$stepLength&&$.each(t.$step,function(n,i){return $(i).position().top+t.currentP<=e+5&&$(i).position().top+t.currentP+$(i).height()>=e+5&&!$(i).hasClass("current-step")?(t.$step.removeClass("current-step"),$(i).addClass("current-step"),!1):void 0}),t.parallaxBg&&t.$current.css({"background-position-y":e*t.parallaxBg}),t.$fade.length&&t.$fade.css({opacity:1-e/t.$fade.attr("data-fade")}),t.$slowScroll.length&&t.$slowScroll.css({"margin-top":e/t.$slowScroll.attr("data-slow-scroll")})}else t._ignoreHashChange=!0,t.$current.next().attr("id")&&t.setHash(t.$current.next().attr("id")),t.$current.removeClass("current").addClass("hidden").next("li").addClass("current").next("li").removeClass("hidden"),t.setCache(),t.options.nextSlide()},scrollMobileEvent:function(){var t=this,e=t.$element.scrollTop();e+10<t.currentP&&t.currentIndex>0?(t._ignoreHashChange=!0,t.$current.prev().attr("id")&&t.setHash(t.$current.prev().attr("id")),t.$current.removeClass("current").prev().addClass("current"),t.setCache(),t.options.prevSlide()):e+10<t.currentP+t.currentHeight?t.$stepLength&&$.each(t.$step,function(n,i){$(i).position().top+t.currentP<=e&&$(i).position().top+t.currentP+$(i).outerHeight()>=e&&($(i).hasClass("current-step")||(t.$step.removeClass("current-step"),$(i).addClass("current-step")))}):(t._ignoreHashChange=!0,t.$current.next().attr("id")&&t.setHash(t.$current.next().attr("id")),t.$current.removeClass("current").next().addClass("current"),t.setCache(),t.options.nextSlide())},setDimensions:function(){var t=this,e=0,n=!1,i=null;t.$windowHeight=t.$window.height(),this.$li.each(function(s){var o=$(this);if(n=o.hasClass("cover"),n?(o.css({height:t.$windowHeight,zIndex:999-s}).attr("data-height",t.$windowHeight).attr("data-position",e),t.$elDatas[o.index()]={"data-height":parseInt(t.$windowHeight,10),"data-position":parseInt(e,10)},e+=t.$windowHeight):(i=o.outerHeight()<=t.$windowHeight?t.$windowHeight:o.outerHeight(),o.css({minHeight:i,zIndex:999-s}).attr("data-height",i).attr("data-position",e),t.$elDatas[o.index()]={"data-height":parseInt(i,10),"data-position":parseInt(e,10)},e+=i),o.find(".fixed").length){var r=o.find(".fixed").css("top");o.find(".fixed").attr("data-top",r)}}),this.options.mobile||this.setBodyHeight()},setEvents:function(){var e=this;$(t).on("resize",function(){e.setDimensions()}),e.options.mobile?e.$element.on("scroll",function(){e.scrollMobileEvent()}):e.$window.on("scroll",function(){e.scrollEvent()}),e.options.enableKeys&&e.$document.on("keydown",function(t){return 38===t.keyCode||37===t.keyCode?(e.scrollToPosition("up"),t.preventDefault(),!1):40===t.keyCode||39===t.keyCode?(e.scrollToPosition("down"),t.preventDefault(),!1):36===t.keyCode?(e.scrollToPosition("top"),t.preventDefault(),!1):35===t.keyCode?(e.scrollToPosition("bottom"),t.preventDefault(),!1):void 0}),e.options.scrollButtons&&(e.options.scrollButtons.up&&e.options.scrollButtons.up.on("click",function(t){t.preventDefault(),e.scrollToPosition("up")}),e.options.scrollButtons.down&&e.options.scrollButtons.down.on("click",function(t){t.preventDefault(),e.scrollToPosition("down")})),e.options.curtainLinks&&$(e.options.curtainLinks).on("click",function(t){t.preventDefault();var n=$(this).attr("href");if(!e.isHashIsOnList(n.substring(1))&&i)return!1;var i=e.$elDatas[$(n).index()]["data-position"]||null;return i&&e.scrollEl.animate({scrollTop:i},e.options.scrollSpeed,e.options.easing),!1}),e.$window.on("hashchange",function(t){e._ignoreHashChange===!1&&e.isHashIsOnList(location.hash.substring(1)),e._ignoreHashChange=!1})},setBodyHeight:function(){var t=0;for(var e in this.$elDatas){var n=this.$elDatas[e];t+=n["data-height"]}this.options.bodyHeight=t,$("body").height(t)},setLinks:function(){var t=this;this.$li.each(function(){var e=$(this).attr("id")||0;t.options.linksArray.push(e)})},setHash:function(t){el=$("[href=#"+t+"]"),el.parent().siblings("li").removeClass("active"),el.parent().addClass("active"),history.pushState?history.pushState(null,null,"#"+t):location.hash=t},setCache:function(){var t=this;t.$current=t.$element.find(".current"),t.$fixed=t.$current.find(".fixed"),t.$fixedLength=t.$fixed.length,t.$step=t.$current.find(".step"),t.$stepLength=t.$step.length,t.currentIndex=t.$current.index(),t.currentP=t.$elDatas[t.currentIndex]["data-position"],t.currentHeight=t.$elDatas[t.currentIndex]["data-height"],t.parallaxBg=t.$current.attr("data-parallax-background"),t.$fade=t.$current.find("[data-fade]"),t.$slowScroll=t.$current.find("[data-slow-scroll]")},isHashIsOnList:function(t){var e=this;$.each(e.options.linksArray,function(n,i){return i===t?(e.scrollToPosition(t),!1):void 0})},readyElement:function(t,e){var n=setInterval(function(){t.length&&(e(t.length),clearInterval(n))},60)},imageLoaded:function(t){var e=this,i=e.$element.find("img"),s=i.length,o="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==";i.bind("load.imgloaded",function(){(--s<=0&&this.src!==o||$(this).not(":visible"))&&(i.unbind("load.imgloaded"),t.call(i,this))}).each(function(){if(this.complete||this.complete===n){var t=this.src;this.src=o,this.src=t}})}},$.fn[s]=function(t){return this.each(function(){$.data(this,"plugin_"+s)||$.data(this,"plugin_"+s,new i(this,t))})}}($,window,document);